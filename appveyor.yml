#
# https://ci.appveyor.com/tools/encrypt
#

version: "{build}"
image: Visual Studio 2019

branches:
  only: 
    - master

artifacts:
  - path: '**\*.zip'
    name: REDasm

init:
- ps: Update-AppveyorBuild -Version "REDasm_Windows_x86_64_$(Get-Date -format yyyyMMdd)_$env:appveyor_build_number"

skip_tags: true

install:
  - git submodule update --init --recursive
  - set QTCREATOR=C:\Qt\Tools\QtCreator\bin
  - set QTDIR=C:\Qt\5.15.2\msvc2019_64\bin
  - set PYTHONDIR=C:\Python37-x64
  - set PATH=%QTDIR%;%QTCREATOR%;%PYTHONDIR%;%PATH%
  - call "C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build\vcvars64.bat"

build_script:
  - mkdir build
  - cd build
  - cmake ..
  - cmake --build . -j4 --config Release
  - cmake --build . --target REDasmDeploy
